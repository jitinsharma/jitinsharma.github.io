{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/lessons-learnt-from-vector-drawables/","result":{"data":{"markdownRemark":{"id":"1e0243cb-6723-56f8-81e6-8d784ec2aea2","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/90a2c0f682fb9cd20b5379bf19928b6c/c8551/vector-header.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAXElEQVR42lWMQQoAIQwD/f+z/IUHz4KXoqKiqFlSUNi5tGnDGO891logYwyICC4pJcQYX+69a+dirUUpRfdzDmqtMDln7L31SDElfJIQApxzP+Gc82XKb5eztYYPGQSbqh6DLs4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/90a2c0f682fb9cd20b5379bf19928b6c/8ac56/vector-header.webp 240w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/d3be9/vector-header.webp 480w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/e46b2/vector-header.webp 960w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/f992d/vector-header.webp 1440w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/882b9/vector-header.webp 1920w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/38df0/vector-header.webp 2814w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/90a2c0f682fb9cd20b5379bf19928b6c/8ff5a/vector-header.png 240w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/e85cb/vector-header.png 480w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/d9199/vector-header.png 960w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/07a9c/vector-header.png 1440w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/29114/vector-header.png 1920w,\n/static/90a2c0f682fb9cd20b5379bf19928b6c/c8551/vector-header.png 2814w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/90a2c0f682fb9cd20b5379bf19928b6c/d9199/vector-header.png\"\n            alt=\"vector header\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Dialing back to days of Android 5.0 release(s) one of the things which got a lot of people excited was Android got support for SVGs in form of vector Drawables. No longer you were required to draw custom shapes or have icon png(s) based on density, just import SVGs using Android Studio and let the support library draw them for you!</p>\n<p>This article is more or less a list of lessons which I’ve learnt while working with vectors and how to make sure to use vectors safely avoiding crashes on devices with API level less than 21.</p>\n<h2 id=\"without-support-library\" style=\"position:relative;\"><a href=\"#without-support-library\" aria-label=\"without support library permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Without Support Library</h2>\n<p>By default, if you don’t enable support library use all vector drawables are converted to pngs in their density folders. While this means you’ll never face an rendering issue since pngs are supported in all versions of Android, this will definitely increased size of your app by a lot if you heavily depend on vectors.</p>\n<p>Here’s how a vector xml file in transformed into multiple pngs during build cycle</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ad9a0eeae5df49192070d7adbb59071c/6e88f/vector-png.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABvklEQVR42pWTXXOaQBSG/TdtOr1tmpuKgiAg+wXsAoLyoWbS6cf/v3t72KSJqWNKLt5xOO4+PGc5O1NKII6WqNMAJxOhMAKC+WCxi03o2CThAozWjEmuhMVLROsFZkpJWjiHZCuc8hV+NhynQ42uyVDpBNuCw6QhRLyA2CyvRiZL++KZlJyADhgVC+njh/awrRTaOkW/N2gqiR09bw2zcMW8t4GjIScgp6IWPn4VAbqSQYrgsU5m/MlOJu7/DT3vZRGjjRn38UCtP7QaJbWc0ksySkp1MQ34+g9Omxrl43cVoh9qalvb1sfkcv1sO8nwb1Lm4rv2cU+WQ1daWJHHdtO7Wn6Mi5yAA41Qu9PWsK0zsguu2r0J5ATUBOyLGB3Z3Q9bO0ImjaaNjfvvGY5A7qEnw/3OoNvl2NMI5Wo9DbhaeRdAw10cyxgD2R37EgcyLbJ4WstCMDtv58DxDFtNhk1uB7ylX63CdwBj5+IMD8WGvnCFI9mdhsrelEnAJKFxGAvPoZbpenUmPDPMCJjY+/x67UsUAdkIdFYhPt7OcfPVecoCn+8cOEGEQJUIpaEUmIccH758O1t3mU+3c/wBeR80tpPa1NUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ad9a0eeae5df49192070d7adbb59071c/8ac56/vector-png.webp 240w,\n/static/ad9a0eeae5df49192070d7adbb59071c/d3be9/vector-png.webp 480w,\n/static/ad9a0eeae5df49192070d7adbb59071c/49232/vector-png.webp 562w\"\n              sizes=\"(max-width: 562px) 100vw, 562px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ad9a0eeae5df49192070d7adbb59071c/8ff5a/vector-png.png 240w,\n/static/ad9a0eeae5df49192070d7adbb59071c/e85cb/vector-png.png 480w,\n/static/ad9a0eeae5df49192070d7adbb59071c/6e88f/vector-png.png 562w\"\n            sizes=\"(max-width: 562px) 100vw, 562px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ad9a0eeae5df49192070d7adbb59071c/6e88f/vector-png.png\"\n            alt=\"vector png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>This rasterization into pngs modifies after build size of one vector(in this case) from 2kb to 7kb which is more than <strong>3x</strong> size increase.</p>\n<p>Ideally this approach should be avoided if your app has a lot of vectors. Let’s look into next section on how to work with Support Library.</p>\n<h2 id=\"with-support-library\" style=\"position:relative;\"><a href=\"#with-support-library\" aria-label=\"with support library permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>With Support Library</h2>\n<p>To use vectors with support library, there is a simple flag which can be added in <code class=\"language-text\">build.gradle</code></p>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\">android <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">...</span>\n    vectorDrawables<span class=\"token punctuation\">.</span>useSupportLibrary <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>and add following code to your Application class’s <code class=\"language-text\">onCreate</code></p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">AppCompatDelegate<span class=\"token punctuation\">.</span><span class=\"token function\">setCompatVectorFromResourcesEnabled</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Using support library means there is no conversion of xml to pngs based on density, instead these drawables are drawn on runtime on canvas.</p>\n<p>Following this we will broadly divide usage into following sections</p>\n<ul>\n<li><a href=\"#using-vector-drawables-in-framework-components\">Using vector drawables in Framework Components</a></li>\n<li><a href=\"#loading-drawables-outside-xml\">Loading drawables outside xml</a></li>\n<li><a href=\"#working-with-custom-views\">Working with custom views</a></li>\n<li><a href=\"#safeguarding-with-lint\">Safeguarding with lint</a></li>\n<li><a href=\"#tl-dr\">TL;DR</a></li>\n</ul>\n<h3 id=\"using-vector-drawables-in-framework-components\" style=\"position:relative;\"><a href=\"#using-vector-drawables-in-framework-components\" aria-label=\"using vector drawables in framework components permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using vector drawables in Framework Components</h3>\n<p>A very straightforward way of using vectors is <code class=\"language-text\">ImageView</code> which can be used for icons/shapes etc.</p>\n<p>Since vectors are not supported natively, they always should be used with <code class=\"language-text\">app</code> namespace. Android Studio does a good job to let you know the same for <code class=\"language-text\">ImageView</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a845613296359c96e6a0688a55c8461/061c7/vector-imageview.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABD0lEQVR42lWQ7W6CQBREeRwrsAuyfIoIS0UKtTaxFbDv/xynV5um6Y+TzM69mZ1dZ7dv+CVJc4wxlKmmKQ0vbc6+SAhNyCbZEGUR4SZAaYXWGh3oh1bqD+ceVFY/5EVJZGI2ocL3fWzRYbcdx6GnPx0ZzyP22JDuDNkupqjlsijA93zZVw+cfW2pbftoWDU/2vM8Ah1QpaWE1lTFlixPyLYJaRETpxFxHmGksQokTHnS1JNgF2d4PTHNNz6F67yIXphvX0zLHfGnWbyZj+sk50V2Zpnf/YnT+V2KVKjQJ5RXBRLs2G7k8DYLC8/jha4fsJ0wXLDjlUbmbddTt4f/2ANN28mfJzytVrhrl/Xa5Rtxy6ykvK3cMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8a845613296359c96e6a0688a55c8461/8ac56/vector-imageview.webp 240w,\n/static/8a845613296359c96e6a0688a55c8461/d3be9/vector-imageview.webp 480w,\n/static/8a845613296359c96e6a0688a55c8461/e46b2/vector-imageview.webp 960w,\n/static/8a845613296359c96e6a0688a55c8461/77293/vector-imageview.webp 1216w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8a845613296359c96e6a0688a55c8461/8ff5a/vector-imageview.png 240w,\n/static/8a845613296359c96e6a0688a55c8461/e85cb/vector-imageview.png 480w,\n/static/8a845613296359c96e6a0688a55c8461/d9199/vector-imageview.png 960w,\n/static/8a845613296359c96e6a0688a55c8461/061c7/vector-imageview.png 1216w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8a845613296359c96e6a0688a55c8461/d9199/vector-imageview.png\"\n            alt=\"vector imageview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>But let’s look at some other scenarios</p>\n<h4 id=\"textview\" style=\"position:relative;\"><a href=\"#textview\" aria-label=\"textview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TextView</h4>\n<p>We can also set icon to <code class=\"language-text\">TextView</code> as <code class=\"language-text\">drawableStart</code>, <code class=\"language-text\">drawableTop</code> etc.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>drawableStart</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/ic_account<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Account<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>If you run this code on devices with <strong>API &#x3C;21</strong>, you’ll face this error.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Caused by: android.view.InflateException: Binary XML <span class=\"token function\">file</span> line <span class=\"token comment\">#11: Error inflating class TextView</span>\n<span class=\"token punctuation\">..</span>.\nCaused by: android.content.res.Resources<span class=\"token variable\">$NotFoundException</span><span class=\"token builtin class-name\">:</span> File res/drawable/ic_account.xml from drawable resource ID <span class=\"token comment\">#0x7f060060</span></code></pre></div>\n<p>For <code class=\"language-text\">TextView</code>, the solution is already present if you are using <code class=\"language-text\">androidx.appcompat</code> version <code class=\"language-text\">1.1.0</code> or above.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Account<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>drawableStartCompat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/ic_account<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<h4 id=\"other-viewsviewgroups\" style=\"position:relative;\"><a href=\"#other-viewsviewgroups\" aria-label=\"other viewsviewgroups permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Other Views/ViewGroups</h4>\n<p>Unfortunately, Android Studio doesn’t warn if vectors are used with <code class=\"language-text\">android</code> namespace in components other than <code class=\"language-text\">ImageView</code> which makes it harder to find out where vector rendering might become a problem. There are a lot of practical use cases where you could use vectors outside of <code class=\"language-text\">ImageView</code> such as background of a smaller <code class=\"language-text\">ViewGroup</code> and also you can use them to draw complex shapes without writing <code class=\"language-text\">canvas</code> related code yourself.</p>\n<p>In such cases, a there are two ways to use vectors with <code class=\"language-text\">android</code> namespace</p>\n<ol>\n<li>Wrap them in a <code class=\"language-text\">StateList</code> drawable</li>\n</ol>\n<p><code class=\"language-text\">ic_account_statelist.xml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>selector</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>drawable</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/ic_account<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>selector</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>By creating <code class=\"language-text\">StateList</code>, this drawable can used with <code class=\"language-text\">android</code> namespace anywhere and should work below API 21, though this requires you to create on extra file per vector.</p>\n<ol start=\"2\">\n<li>Load vectors as drawables and set them outside of xml in Kotlin/Java</li>\n</ol>\n<p>You can set drawables to <code class=\"language-text\">TextView</code>, <code class=\"language-text\">ViewGroup</code> etc outside of xml also</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">viewGroup<span class=\"token punctuation\">.</span>background <span class=\"token operator\">=</span> yourDrawable\ntextView<span class=\"token punctuation\">.</span><span class=\"token function\">setCompoundDrawables</span><span class=\"token punctuation\">(</span>leftDrawable<span class=\"token punctuation\">,</span> topDrawable<span class=\"token punctuation\">,</span> rightDrawable<span class=\"token punctuation\">,</span> bottomDrawable<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now the question is how to load Drawable.</p>\n<h3 id=\"loading-drawables-outside-xml\" style=\"position:relative;\"><a href=\"#loading-drawables-outside-xml\" aria-label=\"loading drawables outside xml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading drawables outside xml</h3>\n<p>The most common known way of loading drawable is via <code class=\"language-text\">ContextCompat</code></p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">ContextCompat<span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>ic_account<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Also there is another less known way</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">AppCompatResources<span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>ic_account<span class=\"token punctuation\">)</span></code></pre></div>\n<p>In current scenario both will work fine since this is plain vector.\nBut let’s say we have a vector which has a <code class=\"language-text\">gradient</code> tag</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>vector</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>aapt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/aapt<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>9dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>17dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>viewportWidth</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>9<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>viewportHeight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>17<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>pathData</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M7.1921,17L8.0072,17L8.0072,0L0,0L0,9.8079C-0,11.8049 0.2818,12.9046 0.8109,13.894C1.3401,14.8834 2.1166,15.6599 3.106,16.1891C4.0954,16.7182 5.1951,17 7.1921,17Z<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>strokeWidth</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fillType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>evenOdd<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>strokeColor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#00000000<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">aapt:</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:fillColor<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>gradient</span>\n                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>startY</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>17<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>startX</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3.3198788<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>endY</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>17<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>endX</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5.201214<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>linear<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>offset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#000000<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>offset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#FFFFFF<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>gradient</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">aapt:</span>attr</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>path</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>vector</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Loading this vector via <code class=\"language-text\">ContextCompat</code> will throw this error on devices with <strong>API level 21-23</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML <span class=\"token function\">file</span> line <span class=\"token comment\">#13: invalid color state list tag gradient</span></code></pre></div>\n<p>This works fine above <strong>API 23</strong> and even below <strong>API 21</strong> but fails in between these APIs. Weird, right!</p>\n<p>Let’s look at what <code class=\"language-text\">ContextCompat</code> does</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4edb7b4864382e635a7fd16fe9881031/1dbe8/contextcompat-getdrawable.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwklEQVR42l2O226DMBAF+Z1gB9d3bnZNgCRt//97piZCUdWH0c5qpbOnyU4yes3gLamsTHOiDJZ7dpTZkbIihgshRHzsCTFW74lRMk+CcRQE2+KdwVhHozvJOge21LM9f9gf3+zrF9v2pNzu9UFGSokQkra91CnO/Zgn1cVJc70qUv2QnSB9Li+W/UFZdtJ0YxhmxlSIw4jzAaVUDW7fAf9puq4jB4U3isONsWh91Ld8GI3S+uXWuYqvN302k++Qv/4LCeuASwalfrAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4edb7b4864382e635a7fd16fe9881031/8ac56/contextcompat-getdrawable.webp 240w,\n/static/4edb7b4864382e635a7fd16fe9881031/d3be9/contextcompat-getdrawable.webp 480w,\n/static/4edb7b4864382e635a7fd16fe9881031/e46b2/contextcompat-getdrawable.webp 960w,\n/static/4edb7b4864382e635a7fd16fe9881031/04d72/contextcompat-getdrawable.webp 1374w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4edb7b4864382e635a7fd16fe9881031/8ff5a/contextcompat-getdrawable.png 240w,\n/static/4edb7b4864382e635a7fd16fe9881031/e85cb/contextcompat-getdrawable.png 480w,\n/static/4edb7b4864382e635a7fd16fe9881031/d9199/contextcompat-getdrawable.png 960w,\n/static/4edb7b4864382e635a7fd16fe9881031/1dbe8/contextcompat-getdrawable.png 1374w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4edb7b4864382e635a7fd16fe9881031/d9199/contextcompat-getdrawable.png\"\n            alt=\"contextcompat getdrawable\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Above <strong>API 21</strong>, it uses <code class=\"language-text\">context</code> to inflate drawables, but there is a catch. Support for <code class=\"language-text\">gradient</code> tag in vectors was introduced in <strong>API 24</strong> hence resolving drawables via <code class=\"language-text\">context</code> will fail below <strong>API 24</strong> since framework doesn’t know what <code class=\"language-text\">gradient</code> tag is!</p>\n<p>Below <strong>API 21</strong>, it uses <code class=\"language-text\">context.getResources</code> and IIRC, inflation of drawables via <code class=\"language-text\">Resources</code> is intercepted by <code class=\"language-text\">AppCompat</code> and it takes over inflation of drawables.</p>\n<p>This error can be avoided by using <code class=\"language-text\">AppCompatResources</code> instead of <code class=\"language-text\">ContextCompat</code> which works well on all API levels because it does a lot of checks! 😅 Look for yourself</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/08ded04fad34f4b3fcabebe70d21ad24/6f278/appcompatresources-getdrawable.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABsElEQVR42n1T2babMAzM3ySY1eAVCEkO6W2bPrT//zPTkQhdbnP7MMhgW5rRiEPsKiyhxWO2uK8rPn154Me3O74/VtyuAWM28N7ChwTnA2NADCWmsUSKJRzvx5RR1zXKssTBlBV6HxEjwcNpnOEzkWY4JmkaC2NKwugFicZUKIpyg5FYwHBPE9ZVhcwKeVowzhdE7+GHAYHfHAuEEJWBZxT03PMsbq1lgq3InzhUVYmem+vbV0znK3IMmKcZMU8IMWsyiYNzcM5jYMKd7SuQIfvQW9zWz8oy+QFjihjYL2t7JvJk5WD7AV3X6be9Xy8TVpTctA0SGellXpTGiwHOUXIUM6K+i0yJbdt+yFIZ9l2jB4XJ0NWwdaUXTscjTqeTohAUsj5uJphC4z8J5dE0Dc7LTVkGsjsvF2W2Se03UKq870y1OBXULP6OIceGvcnTma7SRdvBu989k2Jt2+m6eyaVAr0YREjL/u4hH3L4cruT2RVTTnR5pLujjkweJ6SU1Ihd6i73pWSp4GzNWUycw+WXq7sRIv2jmXttCisPjaHs9vln1E8DCjVB8L+5e5/wJ6F8eI+b04unAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/08ded04fad34f4b3fcabebe70d21ad24/8ac56/appcompatresources-getdrawable.webp 240w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/d3be9/appcompatresources-getdrawable.webp 480w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/e46b2/appcompatresources-getdrawable.webp 960w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/f992d/appcompatresources-getdrawable.webp 1440w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/a31b7/appcompatresources-getdrawable.webp 1488w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/08ded04fad34f4b3fcabebe70d21ad24/8ff5a/appcompatresources-getdrawable.png 240w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/e85cb/appcompatresources-getdrawable.png 480w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/d9199/appcompatresources-getdrawable.png 960w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/07a9c/appcompatresources-getdrawable.png 1440w,\n/static/08ded04fad34f4b3fcabebe70d21ad24/6f278/appcompatresources-getdrawable.png 1488w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/08ded04fad34f4b3fcabebe70d21ad24/d9199/appcompatresources-getdrawable.png\"\n            alt=\"appcompatresources getdrawable\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Preferring <code class=\"language-text\">AppCompatResources</code> becomes fairly important if you have a utility class or an extension function to load drawables app wide, since that class won’t be aware of what kind of drawables it’s receiveing.</p>\n<h3 id=\"working-with-custom-views\" style=\"position:relative;\"><a href=\"#working-with-custom-views\" aria-label=\"working with custom views permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Working with custom views</h3>\n<p>If your app has Custom Views in it, it might be possible that you are receveing drawable references through custom attributes. These attributes can then resolve drawables via <code class=\"language-text\">TypedArray</code></p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">class</span> <span class=\"token function\">TrafficView</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> Context<span class=\"token punctuation\">,</span> attrs<span class=\"token operator\">:</span> AttributeSet<span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">View</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> attrs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">init</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">val</span> typedArray <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span>theme<span class=\"token punctuation\">.</span><span class=\"token function\">obtainStyledAttributes</span><span class=\"token punctuation\">(</span>attrs<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>TrafficView<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">val</span> drawable <span class=\"token operator\">=</span> typedArray<span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>TrafficView_image_src<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">addDrawable</span><span class=\"token punctuation\">(</span>drawable<span class=\"token punctuation\">)</span>\n        typedArray<span class=\"token punctuation\">.</span><span class=\"token function\">recycle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">typedArray.getDrawable</code> will fail below <strong>API 21</strong> if drawable has a vector tag in it. This is also one of the reasons <code class=\"language-text\">android</code> namespace in framework components cannot resolve vectors since <code class=\"language-text\">TypedArray</code> is bound to framework API level and cannot be overriden by <code class=\"language-text\">AppCompat</code>.</p>\n<p>For custom views this can be solved by creating an extension function</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> TypedArray<span class=\"token punctuation\">.</span><span class=\"token function\">getDrawableCompat</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> Context<span class=\"token punctuation\">,</span> <span class=\"token annotation builtin\">@StyleableRes</span> id<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Drawable<span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">val</span> resource <span class=\"token operator\">=</span> <span class=\"token function\">getResourceId</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resource <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> AppCompatResouces<span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> resource<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here instead of inflating <code class=\"language-text\">Drawable</code> via <code class=\"language-text\">TypedArray</code>, we just retrieve resourceId from it and then use <code class=\"language-text\">AppCompatResources</code> to safely inflate the drawable.</p>\n<h3 id=\"safeguarding-with-lint\" style=\"position:relative;\"><a href=\"#safeguarding-with-lint\" aria-label=\"safeguarding with lint permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Safeguarding with Lint</h3>\n<p>Android Studio’s lint checks may not be enough if you’re using vectors heavily in your app and often use it outside of <code class=\"language-text\">ImageView</code>. In such cases it might be beneficial to write your own lint rule to prevent runtime issues.</p>\n<p>Here are two examples which will cause crash at runtime where we are using vector with <code class=\"language-text\">android</code> namespace on API levels below 21.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/003c4bea5e79a52f002a766d1585f9e5/d5bfb/linear-layout-vector.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAxklEQVR42nXOS06EQBRGYZYj74YqupDmkTZtNKEI0BSKQtj/Lo4oONPBl/OPbq6ViIBbKXmuFK/XlESecH0XP/AO/s7ft7fVdd1/WY7jEAUxlbqSq5KiyFGXhMdckeZnYhUi0wihTsgswg897Acb2/6b9X01U5ftu5pb9ULTNOhao3VDrWuKp4xyUxySRCKEQEhBLOJ9H5VSYoVhiLmPfJiZyXyyLAvrujLPM+NkGKae4b2nNy33saMb2n2/dT/tzW9blnniC4hIh84PzRt7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/003c4bea5e79a52f002a766d1585f9e5/8ac56/linear-layout-vector.webp 240w,\n/static/003c4bea5e79a52f002a766d1585f9e5/d3be9/linear-layout-vector.webp 480w,\n/static/003c4bea5e79a52f002a766d1585f9e5/e46b2/linear-layout-vector.webp 960w,\n/static/003c4bea5e79a52f002a766d1585f9e5/f13ee/linear-layout-vector.webp 1072w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/003c4bea5e79a52f002a766d1585f9e5/8ff5a/linear-layout-vector.png 240w,\n/static/003c4bea5e79a52f002a766d1585f9e5/e85cb/linear-layout-vector.png 480w,\n/static/003c4bea5e79a52f002a766d1585f9e5/d9199/linear-layout-vector.png 960w,\n/static/003c4bea5e79a52f002a766d1585f9e5/d5bfb/linear-layout-vector.png 1072w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/003c4bea5e79a52f002a766d1585f9e5/d9199/linear-layout-vector.png\"\n            alt=\"linear layout vector\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 818px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af182ed1a0bcdcb90ee9def1e73d8928/64d87/textview-vector.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.499999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABC0lEQVR42m3OSW6DQBCFYU5jBg8ET5DEDvFIg8F0N4OEZSzf/xJ/OngVKYtPr14tSmUluyW7bUB6mPOxnmE7Dq7r4AzpDvmavX953l/Wcj7hfbnguNnyuYrwZ2+s1yuiKCIIAsIwHMzmU/zFhPHUY+qPTZ/gG67nMhrZ2PaLZTsu+/hMftJkxyvJSSClRGtNnucopUxXnNMThzRmn3wT77ccxO8c87XbmAfWgzCMsJLkTCNbOt3TyhuVqrnf7zyfT263G33fD72qNWVzMXIKlSHrnNLICoHIkkEqTlhCCGrV0KqOqmzRqjKHOh6PB13X0bbtkEorCp0jqwLZFFyVOSwvZHlKaXZXoywEPw0Hr8rYIXyEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/af182ed1a0bcdcb90ee9def1e73d8928/8ac56/textview-vector.webp 240w,\n/static/af182ed1a0bcdcb90ee9def1e73d8928/d3be9/textview-vector.webp 480w,\n/static/af182ed1a0bcdcb90ee9def1e73d8928/3a941/textview-vector.webp 818w\"\n              sizes=\"(max-width: 818px) 100vw, 818px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/af182ed1a0bcdcb90ee9def1e73d8928/8ff5a/textview-vector.png 240w,\n/static/af182ed1a0bcdcb90ee9def1e73d8928/e85cb/textview-vector.png 480w,\n/static/af182ed1a0bcdcb90ee9def1e73d8928/64d87/textview-vector.png 818w\"\n            sizes=\"(max-width: 818px) 100vw, 818px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/af182ed1a0bcdcb90ee9def1e73d8928/64d87/textview-vector.png\"\n            alt=\"textview vector\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>We can write a custom lint rule which will then give out errors in XML whenever vectors are used without <code class=\"language-text\">app</code> namespace.</p>\n<details>\n<summary><u><code class=\"language-kotlin\">VectorUsageDetector</code></u></summary>\n<p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">class</span> VectorUsageDetector <span class=\"token operator\">:</span> <span class=\"token function\">ResourceXmlDetector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">companion</span> <span class=\"token keyword\">object</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">val</span> VECTOR_ISSUE <span class=\"token operator\">=</span> Issue<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>\n                id <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"Vector Usage Issue\"</span></span><span class=\"token punctuation\">,</span>\n                briefDescription <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"Warns usage of vectors with `android` namespace\"</span></span><span class=\"token punctuation\">,</span>\n                explanation <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"Vectors with `android` are not supported in API level below 21\"</span></span><span class=\"token punctuation\">,</span>\n                category <span class=\"token operator\">=</span> Category<span class=\"token punctuation\">.</span>CORRECTNESS<span class=\"token punctuation\">,</span>\n                severity <span class=\"token operator\">=</span> Severity<span class=\"token punctuation\">.</span>ERROR<span class=\"token punctuation\">,</span>\n                implementation <span class=\"token operator\">=</span> <span class=\"token function\">Implementation</span><span class=\"token punctuation\">(</span>\n                        VectorUsageDetector<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">,</span>\n                        Scope<span class=\"token punctuation\">.</span>RESOURCE_FILE_SCOPE\n                <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">appliesTo</span><span class=\"token punctuation\">(</span>folderType<span class=\"token operator\">:</span> ResourceFolderType<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Boolean <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> folderType <span class=\"token operator\">==</span> ResourceFolderType<span class=\"token punctuation\">.</span>LAYOUT\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">getApplicableAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Collection<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">></span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> XmlScannerConstants<span class=\"token punctuation\">.</span>ALL\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">visitAttribute</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> XmlContext<span class=\"token punctuation\">,</span> attribute<span class=\"token operator\">:</span> Attr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">val</span> name <span class=\"token operator\">=</span> attribute<span class=\"token punctuation\">.</span>name\n        <span class=\"token keyword\">val</span> value <span class=\"token operator\">=</span> attribute<span class=\"token punctuation\">.</span>value\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"android:\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"drawable\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">val</span> isVectorDrawable <span class=\"token operator\">=</span> <span class=\"token function\">isVectorDrawable</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"@drawable/\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isVectorDrawable<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                context<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span>\n                        VECTOR_ISSUE<span class=\"token punctuation\">,</span>\n                        attribute<span class=\"token punctuation\">,</span>\n                        context<span class=\"token punctuation\">.</span><span class=\"token function\">getValueLocation</span><span class=\"token punctuation\">(</span>attribute<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string-literal singleline\"><span class=\"token string\">\"Vector is used without `app` namespace. This can cause a crash on API levels below 21.\"</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">isVectorDrawable</span><span class=\"token punctuation\">(</span>name<span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span> context<span class=\"token operator\">:</span> XmlContext<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Boolean <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> isVectorDrawable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n        context<span class=\"token punctuation\">.</span>mainProject<span class=\"token punctuation\">.</span>resourceFolders<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span> <span class=\"token punctuation\">{</span> folder <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">val</span> path <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span>path\n            <span class=\"token keyword\">val</span> drawableFolder <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">path</span></span><span class=\"token string\">/drawable/\"</span></span>\n            <span class=\"token keyword\">val</span> drawableFile <span class=\"token operator\">=</span> <span class=\"token function\">File</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">drawableFolder</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">name</span></span><span class=\"token string\">.xml\"</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>drawableFile<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                drawableFile<span class=\"token punctuation\">.</span><span class=\"token function\">forEachLine</span> <span class=\"token punctuation\">{</span> lineString <span class=\"token operator\">-></span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>lineString<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>TAG_VECTOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> isVectorDrawable <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> isVectorDrawable\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</p>\n</details>  \n<p>Here’s how it looks like with lint rule in place.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f0c6cd047ad94077b691a0c6b1d65a55/e9140/linear-layout-lint-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.750000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABGElEQVR42oWRUY6DMAxEOU8hUOhCEwKhBCgstCtVEEJ7/3vMGlhV/duPpxk7sh0nTilPqFUClZ7AGIPH3DeMeaQemE/quXDd/3FEzNFkNYpMIc0FuDxDZBxfPEIsol1pmO8zuIeP4sMHnw15LFHJDhel0fc9uvYb7bWFaiREkeCcxeC0QZRECMIAx/D4Jlj1GNAw/40jkhSXVEPRDZumhtYlciVRFBwqP0OmCXmxaSYTyJU0Ri7XmLbhMTUNCRoQBHDM8sRjmjDZJ8bZbqx+ti/MywujsbunnLELDJ1vkLfLnh+Nwc/jgapp4FT3BXowxAx9m1ERepig+2nz5fAXDxZVd0fddijb217TG5TXHhU9UVlf6Q8UfgFW0M2/Pm2a1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f0c6cd047ad94077b691a0c6b1d65a55/8ac56/linear-layout-lint-error.webp 240w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/d3be9/linear-layout-lint-error.webp 480w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/e46b2/linear-layout-lint-error.webp 960w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/ab43a/linear-layout-lint-error.webp 1226w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f0c6cd047ad94077b691a0c6b1d65a55/8ff5a/linear-layout-lint-error.png 240w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/e85cb/linear-layout-lint-error.png 480w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/d9199/linear-layout-lint-error.png 960w,\n/static/f0c6cd047ad94077b691a0c6b1d65a55/e9140/linear-layout-lint-error.png 1226w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f0c6cd047ad94077b691a0c6b1d65a55/d9199/linear-layout-lint-error.png\"\n            alt=\"linear layout lint error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4bfacda6be1554f575b9acf9997bbe4d/11a8f/textview-lint-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA7klEQVR42n2N606EMBCFeRsRKBdhV5CiDdDtyhJLuUSDie//FsdpSfxhjD++zJw5M2e8KApRlylafsJDloCxGHF8YD0HixCGIYIgcPU/PHtY5Bm6psNLLdC2LYQQ6LoWtShxqnJHSQ/TLKVw9vPwLzzmFhLwswAvn9HL3oVaKv6IuilQPeWo+RllVdDzBEkSw979xgX6vg/eNFi3DXqaMC8LzDLDzAfrutBcwxhD3jHT1NvdiarVEzGMI6RS8O79O1SNwHX+gnx7h5p2XM0nlP7AhbD9MB9a6h3qpqGGG/pxI3+HHFfSI3r1CtFJfAOW16q9h3RdtwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4bfacda6be1554f575b9acf9997bbe4d/8ac56/textview-lint-error.webp 240w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/d3be9/textview-lint-error.webp 480w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/e46b2/textview-lint-error.webp 960w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/4cec6/textview-lint-error.webp 1272w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4bfacda6be1554f575b9acf9997bbe4d/8ff5a/textview-lint-error.png 240w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/e85cb/textview-lint-error.png 480w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/d9199/textview-lint-error.png 960w,\n/static/4bfacda6be1554f575b9acf9997bbe4d/11a8f/textview-lint-error.png 1272w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4bfacda6be1554f575b9acf9997bbe4d/d9199/textview-lint-error.png\"\n            alt=\"textview lint error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Having instrumentation test case which run on devices with API level less than 21 can also help to catch these errors early.</p>\n<h3 id=\"tl-dr\" style=\"position:relative;\"><a href=\"#tl-dr\" aria-label=\"tl dr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL; DR</h3>\n<ul>\n<li>Vectors are great for icons and small custom shapes, but use them judiciously with support library</li>\n<li>Always use <code class=\"language-text\">AppCompatResouces</code> over <code class=\"language-text\">ContextCompat</code> when loading vector drawables.</li>\n<li>Always prefer <code class=\"language-text\">app</code> namespace when using vector drawables in xml.</li>\n<li>Write Lint rules to safeguard incorrect usage and run instrumentation test cases on device with API level less than 21.</li>\n</ul>\n<h4 id=\"extra-material-on-vectors\" style=\"position:relative;\"><a href=\"#extra-material-on-vectors\" aria-label=\"extra material on vectors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Extra material on Vectors</h4>\n<ul>\n<li>Here’s a 25 min video on Vectors - <a href=\"https://youtu.be/fgbl34me3kk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vector Assets</a></li>\n<li>Here’s a library which extends certain svg functionalities to Vector Drawables - <a href=\"https://github.com/alexjlockwood/kyrie\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kyrie</a></li>\n</ul>\n<p>Thanks for reading!</p>\n<p>Stay safe.</p>","fields":{"slug":"/posts/2020-31-03---lessons-learnt-from-vector-drawables//posts/lessons-learnt-from-vector-drawables/","tagSlugs":["/tag/vectors/","/tag/android/"]},"frontmatter":{"date":"2020-03-31","tags":["Vectors","Android"],"title":"Lessons learnt from Vector Drawables","description":"Working safely with Vector Drawables on different API levels.","slug":"/posts/lessons-learnt-from-vector-drawables/","socialImage":null}}},"pageContext":{"slug":"/posts/2020-31-03---lessons-learnt-from-vector-drawables//posts/lessons-learnt-from-vector-drawables/"}},"staticQueryHashes":["4208939363"],"slicesMap":{}}